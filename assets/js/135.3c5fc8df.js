(window.webpackJsonp=window.webpackJsonp||[]).push([[135],{553:function(s,t,a){"use strict";a.r(t);var e=a(14),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("blockquote",[a("p",[s._v("问题描述：当你正在dev分支下工作的时候，突然接到电话，线上代码出现了bug。线上代码运行在master分支下，你该怎么办？")])]),s._v(" "),a("h2",{attrs:{id:"一、方案一"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、方案一"}},[s._v("#")]),s._v(" 一、方案一")]),s._v(" "),a("ol",[a("li",[s._v("查看"),a("code",[s._v("dev")]),s._v("分支下文件的状态，确保将其"),a("code",[s._v("commit")]),s._v("到本地的仓库区")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" status\n\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" commit -m "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"提交记录描述"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("切换分支到"),a("code",[s._v("master")]),s._v("，并且基于"),a("code",[s._v("master")]),s._v("分支创建新分支"),a("code",[s._v("hotfix")])])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" checkout master\n\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" checkout -b hotfix\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("ol",{attrs:{start:"3"}},[a("li",[a("p",[s._v("在"),a("code",[s._v("hotfix")]),s._v("分支下修改"),a("code",[s._v("bug")]),s._v(",修改结束之后，测试"),a("code",[s._v("bug")])])]),s._v(" "),a("li",[a("p",[s._v("确保"),a("code",[s._v("bug")]),s._v("测试通过之后"),a("code",[s._v("commit")]),s._v("一次")])]),s._v(" "),a("li",[a("p",[s._v("切换到"),a("code",[s._v("master")]),s._v("分支，合并"),a("code",[s._v("hotfix")]),s._v("分支,注意此时的合并方式是："),a("code",[s._v("fast-forward")])])])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" checkout master\n\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" merge hotfix\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("ol",{attrs:{start:"6"}},[a("li",[s._v("此时"),a("code",[s._v("bug")]),s._v("修复工作已完成，切换到"),a("code",[s._v("dev")]),s._v("分支，将"),a("code",[s._v("hotfix")]),s._v("分支的修改内容也合并到"),a("code",[s._v("dev")]),s._v("分支，保证"),a("code",[s._v("dev")]),s._v("分支的代码是最新的。")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" checkout dev\n\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" merge hotfix\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("ol",{attrs:{start:"7"}},[a("li",[s._v("到此为止，"),a("code",[s._v("hotfix")]),s._v("分支已经对我们没有使用价值了，直接删除掉这个分支。")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" branch -d hotfix // 为什么不是-D，你细品\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"二、方案二"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、方案二"}},[s._v("#")]),s._v(" 二、方案二")]),s._v(" "),a("p",[s._v("上面的方案一，可以很轻松的实现线上代码出现"),a("code",[s._v("bug")]),s._v("并修复"),a("code",[s._v("bug")]),s._v("的问题，但是又有新的问题出现，不是一个很完美的方案。")]),s._v(" "),a("blockquote",[a("p",[s._v("例如：正在dev下工作，当前dev分支下的内容还没有被提交，不是不想提交，而是工作只进行了一半，还没法提交，预计完成这个任务还需要5天时间，但是现在必须要在两小时内修复这个"),a("code",[s._v("bug")]),s._v("，接下来该怎么办呢？")])]),s._v(" "),a("p",[s._v("幸好"),a("code",[s._v("git")]),s._v("给我们提供了一个将工作区暂存起来的命令"),a("code",[s._v("git stash")]),s._v("，等将来修复完bug后，再将暂存的内容释放到工作区，"),a("strong",[s._v("注意：暂存的前提是这些文件已经被git追踪的")])]),s._v(" "),a("ol",[a("li",[s._v("接着方案一的要求，先暂存"),a("code",[s._v("dev")]),s._v("分支下的内容")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果存在未追踪的文件，必须先追踪")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 暂存dev分支,这种方式是添加了备注信息，方便查找")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" stash save "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"save message"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("ol",{attrs:{start:"2"}},[a("li",[a("p",[s._v("切换分支到"),a("code",[s._v("master")]),s._v("，并且基于"),a("code",[s._v("master")]),s._v("分支创建"),a("code",[s._v("hotfix")]),s._v("分支")])]),s._v(" "),a("li",[a("p",[s._v("修复"),a("code",[s._v("bug")]),s._v("，并测试，"),a("code",[s._v("commit")]),s._v("相关修改内容")])]),s._v(" "),a("li",[a("p",[s._v("切换到分支"),a("code",[s._v("master")]),s._v("，合并分支"),a("code",[s._v("hotfix")])])]),s._v(" "),a("li",[a("p",[s._v("切换到分支"),a("code",[s._v("dev")]),s._v("，合并分支"),a("code",[s._v("master")])])]),s._v(" "),a("li",[a("p",[s._v("删除"),a("code",[s._v("hotfix")]),s._v("分支")])]),s._v(" "),a("li",[a("p",[s._v("查看暂存内容，恢复已暂存的内容")])])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" stash list\n\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" stash drop\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])])])}),[],!1,null,null,null);t.default=n.exports}}]);