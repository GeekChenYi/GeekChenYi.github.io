---
title: 小程序基础能力
date: 2021-02-04 15:20:00
permalink: /pages/mini-base-06/
categories:
  - 《微信小程序》笔记
tags:
  -
---
# 小程序基础能力

## 网络

### 服务器域名配置

每个微信小程序需要事先设置通讯域名，小程序只可以跟指定的域名进行网络通信。包括普通 `HTTPS` 请求（`wx.request`）、上传文件（`wx.uploadFile`）、下载文件（`wx.downloadFile`) 和` WebSocket `通信（`wx.connectSocket`）。

### 网络请求

#### 超时时间

#### 使用限制

wx.request、wx.uploadFile、wx.downloadFile 的最大并发限制是 10 个

wx.connectSocket 的最大并发限制是 5 个

小程序进入后台运行后，如果 5s 内网络请求没有结束，会回调错误信息 fail interrupted；在回到前台之前，网络请求接口调用都会无法调用。

#### 回调函数

只要成功接收到服务器返回，无论 statusCode 是多少，都会进入 success 回调。请开发者根据业务逻辑对返回值进行判断。

## 文件系统

文件系统是小程序提供的一套以小程序和用户维度隔离的存储以及一套相应的管理接口。通过 wx.getFileSystemManager() 可以获取到全局唯一的文件系统管理器。

文件主要分为两大类：

* 代码包文件：代码包文件指的是在项目目录中添加的文件。

* 本地文件：通过调用接口本地产生，或通过网络下载下来，存储到本地的文件。
  
  * 本地临时文件：临时产生，随时会被回收的文件。不限制存储大小
  
  * 本地缓存文件：小程序通过接口把本地临时文件缓存后产生的文件，不能自定义目录和文件名。跟本地用户文件共计，小程序（含小游戏）最多可存储 200MB。
  
  * 本地用户文件：小程序通过接口把本地临时文件缓存后产生的文件，允许自定义目录和文件名。跟本地缓存文件共计，小程序（含小游戏）最多可存储 200MB。

本地文件指的是小程序被用户添加到手机后，会有一块独立的文件存储区域，以用户维度隔离。即同一台手机，每个微信用户不能访问到其他登录用户的文件，同一个用户不同 appId 之间的文件也不能互相访问。

![本地文件](https://res.wx.qq.com/wxdoc/dist/assets/img/file-sandbox.9ef4d15a.png)

本地临时文件只能通过调用特定接口产生，不能直接写入内容。本地临时文件产生后，仅在当前生命周期内有效，重启之后即不可用。