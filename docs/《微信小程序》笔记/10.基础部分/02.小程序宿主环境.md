---
title: 微信小程序宿主环境
date: 2021-02-03 18:20:00
permalink: /pages/mini-base-02/
categories:
  - 《微信小程序》笔记
tags:
  -
---
# 小程序宿主环境

## 微信小程序注册

注册时可选择类型：订阅号、服务号、小程序、企业微信

> **每个邮箱仅能注册一个小程序。**

> 个人类型小程序：无法使用微信支付、无法使用卡包功能

## 基本概念

微信客户端给小程序提供的运行环境为宿主环境，小程序借助宿主环境提供的能力，可以完成许多普通网页无法完成的功能

小程序的运行环境分为：
 * 逻辑层（JS）
 * 渲染层（WXML、WXSS）

渲染层和逻辑层分别有两个不同的线程管理，渲染层使用了WebView进行渲染，逻辑层使用了JsCore线程运行JS脚本

> 一个小程序存在多个界面，所以也存在多个webview线程，可以理解为：一个界面对应一个webview线程

示意图

![示意图](https://res.wx.qq.com/wxdoc/dist/assets/img/4-1.ad156d1c.png)

## 运行环境

整个小程序只有一个 App 实例，是全部页面共享的。

```javascript

App({
  onLaunch(){
    // 小程序启动之后触发
  }
})

```

### 页面Page

Page 是一个页面构造器，这个构造器就生成了一个页面。在生成页面的时候，小程序框架会把 data 数据和 index.wxml 一起渲染出最终的结构，于是就得到了你看到的小程序的样子。

在渲染完界面之后，页面实例就会收到一个 onLoad 的回调，你可以在这个回调处理你的逻辑。

### 组件

小程序提供了丰富的基础组件给开发者，开发者可以像搭积木一样，组合各种组件拼合成自己的小程序。

### API

为了让开发者可以很方便的调起微信提供的能力，例如获取用户信息、微信支付等等，小程序提供了很多 API 给开发者去使用。

### 场景值

场景值用来描述用户进入小程序的路径。完整场景值的含义请查看[场景值列表](https://developers.weixin.qq.com/miniprogram/dev/reference/scene-list.html)。

由于Android系统限制，目前无法获取到按Home将退出到桌面，然后从桌面再次进入小程序的场景值，对于这种情况，会保留上一次的场景值。

小程序获取场景值的方式

* 在APP的`onLaunch`和`onShow`方法中
* `wx.getLaunchOptionsSync`中获取